<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#F2F4F8">
    <title>TempMail - Email Sementara</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/732/732200.png">
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="top-bar">
        <div class="app-name">TempMail</div>
        
        <div class="user-avatar">
            <img src="https://cdn.odzre.my.id/cpz.jpg" alt="User">
        </div>
    </div>

    <!-- Loading Indicator Global -->
    <div id="globalLoading" class="global-loading" style="display: none;">
        <div class="loading-spinner"></div>
    </div>

    <main id="main-container">
        
        <!-- HOME SECTION -->
        <section id="view-home" class="tab-view active">
            <div class="hero-card">
                <div class="icon-glow">
                    <i class="bi bi-shield-lock-fill"></i>
                </div>
                <h2>Temp Identity</h2>
                <p>Gunakan email sementara ini untuk verifikasi agar privasi utamamu tetap aman.</p>
            </div>

            <div class="email-action-area">
                <label>Email Kamu Saat Ini</label>
                <div class="email-display">
                    <span id="emailAddress">Generating...</span>
                    <button onclick="copyEmail()" class="copy-btn" id="copyEmailBtn"><i class="bi bi-copy"></i></button>
                </div>
                <div class="status-indicator">
                    <span class="dot"></span> <span id="timerText">Auto-refresh: 10s</span>
                </div>
            </div>
        </section>

        <!-- INBOX SECTION (READ MESSAGES) -->
        <section id="view-inbox" class="tab-view">
            <div class="section-header">
                <h2>Riwayat Inbox</h2>
                <button onclick="clearInbox()" class="trash-btn" id="clearInboxBtn" title="Hapus Semua Pesan">
                    <i class="bi bi-trash3"></i>
                </button>
            </div>
            <div id="readList" class="message-list"></div>
            <!-- Loading Skeleton untuk Inbox -->
            <div id="readListSkeleton" class="skeleton-list" style="display: none;">
                <div class="skeleton-card"></div>
                <div class="skeleton-card"></div>
                <div class="skeleton-card"></div>
            </div>
        </section>

        <!-- UPDATES SECTION (UNREAD MESSAGES) -->
        <section id="view-updates" class="tab-view">
            <div class="section-header">
                <h2>Update Baru <span class="badge" id="badge-count" style="display:none">0</span></h2>
            </div>
            <div id="unreadList" class="message-list"></div>
            <!-- Loading Skeleton untuk Updates -->
            <div id="unreadListSkeleton" class="skeleton-list" style="display: none;">
                <div class="skeleton-card"></div>
                <div class="skeleton-card"></div>
                <div class="skeleton-card"></div>
            </div>
        </section>

        <!-- DOCS SECTION -->
        <section id="view-docs" class="tab-view">
            <div class="section-header">
                <h2>Dokumentasi</h2>
            </div>
            
            <div class="doc-card" style="border: 2px dashed #E5E7EB; background: transparent; text-align: center;">
                <h3 style="justify-content: center; font-size: 1rem;">Dokumentasi Sistem</h3>
                <p style="margin-bottom: 15px; font-size: 0.85rem;">Baca detail teknis, keamanan, dan arsitektur sistem.</p>
                <a href="docs.html" class="btn-whatsapp" style="background: var(--primary); box-shadow: 0 4px 15px rgba(0,0,0,0.2); width: 100%; justify-content: center; color: white;">
                    <i class="bi bi-book-half"></i> Buka Dokumentasi Penuh
                </a>
            </div>

            <div class="doc-card">
                <h3><i class="bi bi-code-slash"></i> Cara Penggunaan</h3>
                <ul>
                    <li>Tekan tombol <strong>+</strong> atau Home untuk generate email.</li>
                    <li>Salin email dan gunakan untuk daftar akun.</li>
                    <li>Cek tab <strong>Updates</strong> untuk pesan masuk.</li>
                    <li>Klik pesan untuk membaca. Setelah dibaca, pesan pindah ke <strong>Inbox</strong>.</li>
                    <li>Tekan tombol <i class="bi bi-share"></i> di modal pesan untuk membagikan.</li>
                </ul>
            </div>

            <div class="doc-card developer-card">
                <h3>Developer Info</h3>
                <p class="dev-name">JHON FORUM</p>
                <p>Aplikasi ini dibuat untuk melindungi privasi user dari spam.</p>
                <a href="https://whatsapp.com/channel/0029VaLiUSS5q08hPj5mcH0m" target="_blank" class="btn-whatsapp">
                    <i class="bi bi-whatsapp"></i> Join Saluran Developer
                </a>
            </div>
        </section>

    </main>

    <!-- BOTTOM NAVIGATION -->
    <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('view-home', this)">
            <i class="bi bi-house-door"></i>
            <span>Home</span>
        </div>
        
        <div class="nav-item" onclick="switchTab('view-inbox', this)">
            <i class="bi bi-archive"></i>
            <span>Inbox</span>
        </div>

        <div class="nav-fab-wrapper">
            <div class="nav-fab" onclick="confirmNewEmail()" id="newEmailFab">
                <i class="bi bi-plus-lg"></i>
            </div>
        </div>

        <div class="nav-item" onclick="switchTab('view-updates', this)">
            <div class="icon-wrapper">
                <i class="bi bi-bell"></i>
                <div class="nav-dot" id="nav-dot" style="display: none;"></div>
            </div>
            <span>Updates</span>
        </div>

        <div class="nav-item" onclick="switchTab('view-docs', this)">
            <i class="bi bi-grid"></i>
            <span>Docs</span>
        </div>
    </nav>

    <!-- MODAL DETAIL PESAN -->
    <div id="msgModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalSubject">Subject</h3>
                <div class="modal-actions">
                    <button onclick="openShareModal()" class="modal-btn share-btn" id="shareBtnInModal" title="Bagikan">
                        <i class="bi bi-share"></i>
                    </button>
                    <button onclick="closeModal('msgModal')" class="modal-btn close-btn" title="Tutup">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </div>
            </div>
            <div class="modal-meta" id="modalMeta"></div> 
            <div class="modal-body" id="modalBody">...</div>
        </div>
    </div>

    <!-- MODAL SHARE PESAN -->
    <div id="shareMsgModal" class="modal share-modal">
        <div class="modal-content share-content">
            <div class="modal-header">
                <h3>Bagikan Pesan</h3>
                <button onclick="closeModal('shareMsgModal')" class="modal-btn close-btn" title="Tutup">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            
            <p class="share-description">
                Pilih cara membagikan pesan ini
            </p>

            <div class="share-options">
                <button onclick="shareAsImage()" class="share-option" id="shareImageBtn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <i class="bi bi-image"></i>
                    <div class="share-option-text">
                        <strong>Share Gambar</strong>
                        <span>Instagram, Facebook, dll</span>
                    </div>
                </button>
                
                <button onclick="shareToWaText()" class="share-option" style="background: #25D366;">
                    <i class="bi bi-whatsapp"></i>
                    <div class="share-option-text">
                        <strong>Share Teks WA</strong>
                        <span>Kirim ke WhatsApp</span>
                    </div>
                </button>

                <button onclick="copyMessageText()" class="share-option" style="background: var(--primary);">
                    <i class="bi bi-clipboard"></i>
                    <div class="share-option-text">
                        <strong>Copy Teks</strong>
                        <span>Salin ke clipboard</span>
                    </div>
                </button>
            </div>

            <button onclick="closeModal('shareMsgModal')" class="cancel-btn">
                Batal
            </button>
        </div>
    </div>

    <!-- CAPTURE CONTAINER UNTUK GENERATE GAMBAR (HIDDEN) -->
    <div id="capture-container" style="position: fixed; left: -9999px; top: 0;">
        <div id="capture-card" class="capture-card">
            <div class="capture-header">
                <div class="capture-logo">
                    <i class="bi bi-shield-lock-fill"></i> TempMail
                </div>
                <div class="capture-badge">Pesan Sementara</div>
            </div>
            
            <div class="capture-body">
                <div class="capture-field">
                    <div class="capture-label">DARI:</div>
                    <div class="capture-value" id="capEmail">example@mail.com</div>
                </div>
                
                <div class="capture-field">
                    <div class="capture-label">SUBJEK:</div>
                    <div class="capture-value capture-subject" id="capSubject">Subjek Pesan</div>
                </div>
                
                <div class="capture-field">
                    <div class="capture-label">PESAN:</div>
                    <div class="capture-value capture-message" id="capMsg">
                        Isi pesan akan muncul disini...
                    </div>
                </div>
            </div>

            <div class="capture-footer">
                <div>Temporary Email | JHON FORUM</div>
                <div class="capture-time">Â© 2024 TempMail - Privasi Terjaga</div>
            </div>
        </div>
    </div>

    <!-- MODAL ERROR/CONFIRMATION CUSTOM -->
    <div id="confirmModal" class="modal confirm-modal" style="display: none;">
        <div class="modal-content confirm-content">
            <div class="confirm-icon">
                <i class="bi bi-question-circle"></i>
            </div>
            <h3 id="confirmTitle">Konfirmasi</h3>
            <p id="confirmMessage">Apakah Anda yakin?</p>
            <div class="confirm-buttons">
                <button onclick="confirmAction(false)" class="confirm-btn cancel">Batal</button>
                <button onclick="confirmAction(true)" class="confirm-btn ok">Ya</button>
            </div>
        </div>
    </div>

    <!-- TOAST NOTIFICATION -->
    <div id="toast" class="toast">Disalin ke clipboard!</div>

    <!-- Library html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="script.js"></script>
</body>
</html>