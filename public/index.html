<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#F2F4F8" id="themeColor">
    <title>TempMail - Email Sementara</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/732/732200.png">
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Top Bar -->
    <div class="top-bar">
        <div class="app-name">TempMail</div>
        
        <div class="top-bar-actions">
            <!-- Dark Mode Toggle -->
            <button onclick="toggleDarkMode()" class="icon-btn" id="darkModeToggle" title="Dark Mode">
                <i class="bi bi-moon-stars"></i>
            </button>
            
            <!-- User Avatar -->
            <div class="user-avatar">
                <img src="https://cdn.odzre.my.id/cpz.jpg" alt="User">
            </div>
        </div>
    </div>

    <!-- Search Bar -->
    <div class="search-container" id="searchContainer" style="display: none;">
        <div class="search-bar">
            <i class="bi bi-search"></i>
            <input type="text" id="searchInput" placeholder="Cari pesan..." onkeyup="filterMessages()" autocomplete="off">
            <button onclick="clearSearch()" class="clear-search" id="clearSearchBtn" style="display: none;">
                <i class="bi bi-x-lg"></i>
            </button>
        </div>
    </div>

    <main id="main-container">
        
        <!-- HOME SECTION -->
        <section id="view-home" class="tab-view active">
            <div class="hero-card">
                <div class="icon-glow">
                    <i class="bi bi-shield-lock-fill"></i>
                </div>
                <h2>Temp Identity</h2>
                <p>Gunakan email sementara ini untuk verifikasi agar privasi utamamu tetap aman.</p>
            </div>

            <div class="email-action-area">
                <label>Email Kamu Saat Ini</label>
                <div class="email-display">
                    <span id="emailAddress">Memuat...</span>
                    <button onclick="copyEmail()" class="copy-btn" id="copyEmailBtn"><i class="bi bi-copy"></i></button>
                </div>
                <div class="status-indicator">
                    <span class="dot"></span> 
                    <span id="timerText">Auto-refresh: 10s</span>
                </div>
            </div>
            
            <!-- QUICK STATS -->
            <div class="stats-card">
                <h3><i class="bi bi-pie-chart"></i> Statistik Inbox</h3>
                <div class="stats-grid">
                    <div class="stat-item" onclick="switchTab('view-inbox', document.querySelectorAll('.nav-item')[1])">
                        <div class="stat-icon" style="background: #EEF2FF; color: #4F46E5;">
                            <i class="bi bi-envelope"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="totalMessages">0</span>
                            <span class="stat-label">Total Pesan</span>
                        </div>
                    </div>
                    
                    <div class="stat-item" onclick="switchTab('view-updates', document.querySelectorAll('.nav-item')[2])">
                        <div class="stat-icon" style="background: #FEF3C7; color: #F59E0B;">
                            <i class="bi bi-bell"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="unreadMessages">0</span>
                            <span class="stat-label">Belum Dibaca</span>
                        </div>
                    </div>
                    
                    <div class="stat-item" onclick="showShortcutsHelp()">
                        <div class="stat-icon" style="background: #E0F2FE; color: #0EA5E9;">
                            <i class="bi bi-keyboard"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value">?</span>
                            <span class="stat-label">Shortcuts</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RECENT ACTIVITY -->
            <div class="recent-activity">
                <h3><i class="bi bi-clock-history"></i> Aktivitas Terkini</h3>
                <div id="recentActivityList" class="activity-list">
                    <div class="activity-item loading">Memuat aktivitas...</div>
                </div>
            </div>
        </section>

        <!-- INBOX SECTION (READ MESSAGES) -->
        <section id="view-inbox" class="tab-view">
            <div class="section-header">
                <h2>Riwayat Inbox</h2>
                <div class="section-actions">
                    <button onclick="toggleSearch()" class="action-btn" title="Cari">
                        <i class="bi bi-search"></i>
                    </button>
                    <button onclick="exportData()" class="action-btn" title="Backup">
                        <i class="bi bi-download"></i>
                    </button>
                    <button onclick="clearInbox()" class="trash-btn" id="clearInboxBtn" title="Hapus Semua">
                        <i class="bi bi-trash3"></i>
                    </button>
                </div>
            </div>

            <!-- Filter Tabs -->
            <div class="filter-bar">
                <div class="filter-tabs">
                    <button class="filter-tab active" onclick="setFilter('all')" id="filterAll">
                        <i class="bi bi-list-ul"></i> Semua
                    </button>
                    <button class="filter-tab" onclick="setFilter('unread')" id="filterUnread">
                        <i class="bi bi-envelope"></i> Belum Dibaca
                    </button>
                </div>
            </div>

            <div id="readList" class="message-list"></div>
        </section>

        <!-- UPDATES SECTION (UNREAD MESSAGES) -->
        <section id="view-updates" class="tab-view">
            <div class="section-header">
                <h2>Update Baru <span class="badge" id="badge-count">0</span></h2>
                <div class="section-actions">
                    <button onclick="toggleSearch()" class="action-btn" title="Cari">
                        <i class="bi bi-search"></i>
                    </button>
                    <button onclick="markAllAsRead()" class="action-btn" title="Tandai semua dibaca">
                        <i class="bi bi-check-all"></i>
                    </button>
                </div>
            </div>

            <!-- Filter Tabs -->
            <div class="filter-bar">
                <div class="filter-tabs">
                    <button class="filter-tab active" onclick="setFilter('all')" id="filterAllUpdates">
                        <i class="bi bi-list-ul"></i> Semua
                    </button>
                </div>
            </div>

            <div id="unreadList" class="message-list"></div>
        </section>

        <!-- DOCS SECTION -->
        <section id="view-docs" class="tab-view">
            <div class="section-header">
                <h2>Dokumentasi</h2>
                <button onclick="importData()" class="action-btn" title="Restore">
                    <i class="bi bi-upload"></i>
                </button>
            </div>
            
            <div class="doc-card">
                <h3><i class="bi bi-keyboard"></i> Keyboard Shortcuts</h3>
                <ul>
                    <li><strong>Ctrl/Cmd + N</strong> - Buat email baru</li>
                    <li><strong>Ctrl/Cmd + F</strong> - Cari pesan</li>
                    <li><strong>Ctrl/Cmd + D</strong> - Dark mode</li>
                    <li><strong>Ctrl/Cmd + A</strong> - Tandai semua dibaca</li>
                    <li><strong>Alt + 1-4</strong> - Ganti tab</li>
                    <li><strong>Esc</strong> - Tutup modal</li>
                </ul>
            </div>

            <div class="doc-card">
                <h3><i class="bi bi-question-circle"></i> Cara Penggunaan</h3>
                <ul>
                    <li>Tekan tombol <strong>+</strong> untuk generate email baru</li>
                    <li>Klik email untuk menyalin</li>
                    <li>Pesan baru akan muncul di tab Updates</li>
                    <li>Klik pesan untuk membaca</li>
                    <li>Gunakan icon <i class="bi bi-star"></i> untuk menandai penting</li>
                </ul>
            </div>

            <div class="doc-card developer-card">
                <h3>Developer Info</h3>
                <p class="dev-name">JHON FORUM</p>
                <p>Aplikasi ini dibuat untuk melindungi privasi user dari spam.</p>
                <a href="https://whatsapp.com/channel/0029VaLiUSS5q08hPj5mcH0m" target="_blank" class="btn-whatsapp">
                    <i class="bi bi-whatsapp"></i> Join Channel
                </a>
            </div>
        </section>

    </main>

    <!-- BOTTOM NAVIGATION -->
    <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('view-home', this)">
            <i class="bi bi-house-door"></i>
            <span>Home</span>
        </div>
        
        <div class="nav-item" onclick="switchTab('view-inbox', this)">
            <i class="bi bi-archive"></i>
            <span>Inbox</span>
        </div>

        <div class="nav-fab-wrapper">
            <div class="nav-fab" onclick="confirmNewEmail()" id="newEmailFab">
                <i class="bi bi-plus-lg"></i>
            </div>
        </div>

        <div class="nav-item" onclick="switchTab('view-updates', this)">
            <div class="icon-wrapper">
                <i class="bi bi-bell"></i>
                <div class="nav-dot" id="nav-dot"></div>
            </div>
            <span>Updates</span>
        </div>

        <div class="nav-item" onclick="switchTab('view-docs', this)">
            <i class="bi bi-grid"></i>
            <span>Docs</span>
        </div>
    </nav>

    <!-- MODAL DETAIL PESAN -->
    <div id="msgModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalSubject">Subject</h3>
                <div class="modal-actions">
                    <button onclick="toggleStarCurrentMessage()" class="modal-btn" id="starCurrentBtn" title="Tandai penting">
                        <i class="bi bi-star"></i>
                    </button>
                    <button onclick="openShareModal()" class="modal-btn share-btn" title="Bagikan">
                        <i class="bi bi-share"></i>
                    </button>
                    <button onclick="closeModal()" class="modal-btn close-btn" title="Tutup">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </div>
            </div>
            <div class="modal-meta" id="modalMeta"></div>
            <div class="modal-body" id="modalBody">...</div>
        </div>
    </div>

    <!-- MODAL SHARE -->
    <div id="shareMsgModal" class="modal share-modal">
        <div class="modal-content share-content">
            <div class="modal-header">
                <h3>Bagikan Pesan</h3>
                <button onclick="closeModal('shareMsgModal')" class="modal-btn close-btn">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            
            <p class="share-description">Pilih cara membagikan pesan</p>

            <div class="share-options">
                <button onclick="shareToWA()" class="share-option" style="background: #25D366;">
                    <i class="bi bi-whatsapp"></i>
                    <div class="share-option-text">
                        <strong>WhatsApp</strong>
                        <span>Kirim teks ke WA</span>
                    </div>
                </button>

                <button onclick="copyMessageText()" class="share-option" style="background: var(--primary);">
                    <i class="bi bi-clipboard"></i>
                    <div class="share-option-text">
                        <strong>Copy Teks</strong>
                        <span>Salin ke clipboard</span>
                    </div>
                </button>
            </div>

            <button onclick="closeModal('shareMsgModal')" class="cancel-btn">Batal</button>
        </div>
    </div>

    <!-- MODAL SHORTCUTS -->
    <div id="shortcutsModal" class="modal shortcuts-modal">
        <div class="modal-content shortcuts-content">
            <div class="modal-header">
                <h3><i class="bi bi-keyboard"></i> Keyboard Shortcuts</h3>
                <button onclick="closeModal('shortcutsModal')" class="modal-btn close-btn">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            
            <div class="shortcuts-grid">
                <div class="shortcut-item">
                    <kbd>Ctrl/Cmd</kbd> + <kbd>N</kbd> <span>Email baru</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Ctrl/Cmd</kbd> + <kbd>F</kbd> <span>Cari</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Ctrl/Cmd</kbd> + <kbd>D</kbd> <span>Dark mode</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Ctrl/Cmd</kbd> + <kbd>A</kbd> <span>Tandai semua dibaca</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Alt</kbd> + <kbd>1-4</kbd> <span>Ganti tab</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Esc</kbd> <span>Tutup modal</span>
                </div>
            </div>
        </div>
    </div>

    <!-- FILE UPLOAD (HIDDEN) -->
    <input type="file" id="fileImport" accept=".json" style="display: none;">

    <!-- TOAST NOTIFICATION -->
    <div id="toast" class="toast"></div>

    <script src="script.js"></script>
</body>
</html>